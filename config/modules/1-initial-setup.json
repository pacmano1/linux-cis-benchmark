{
  "section": "1",
  "title": "Initial Setup",
  "description": "Filesystem, packages, MAC, bootloader, sysctl, banners, GDM",
  "controls": [
    {
      "id": "1.1.1.1",
      "title": "Ensure cramfs kernel module is not available",
      "type": "kernel-module",
      "module": "cramfs",
      "action": "disable"
    },
    {
      "id": "1.1.1.2",
      "title": "Ensure freevxfs kernel module is not available",
      "type": "kernel-module",
      "module": "freevxfs",
      "action": "disable"
    },
    {
      "id": "1.1.1.3",
      "title": "Ensure hfs kernel module is not available",
      "type": "kernel-module",
      "module": "hfs",
      "action": "disable"
    },
    {
      "id": "1.1.1.4",
      "title": "Ensure hfsplus kernel module is not available",
      "type": "kernel-module",
      "module": "hfsplus",
      "action": "disable"
    },
    {
      "id": "1.1.1.5",
      "title": "Ensure jffs2 kernel module is not available",
      "type": "kernel-module",
      "module": "jffs2",
      "action": "disable"
    },
    {
      "id": "1.1.1.6",
      "title": "Ensure squashfs kernel module is not available",
      "type": "kernel-module",
      "module": "squashfs",
      "action": "disable"
    },
    {
      "id": "1.1.1.7",
      "title": "Ensure udf kernel module is not available",
      "type": "kernel-module",
      "module": "udf",
      "action": "disable"
    },
    {
      "id": "1.1.1.8",
      "title": "Ensure usb-storage kernel module is not available",
      "type": "kernel-module",
      "module": "usb-storage",
      "action": "disable"
    },
    {
      "id": "1.1.2.1",
      "title": "Ensure /tmp is a separate partition",
      "type": "command",
      "audit_cmd": "findmnt -n /tmp",
      "expected": "/tmp",
      "match": "contains"
    },
    {
      "id": "1.1.2.2",
      "title": "Ensure nodev option set on /tmp",
      "type": "mount-option",
      "mount_point": "/tmp",
      "options": ["nodev"]
    },
    {
      "id": "1.1.2.3",
      "title": "Ensure nosuid option set on /tmp",
      "type": "mount-option",
      "mount_point": "/tmp",
      "options": ["nosuid"]
    },
    {
      "id": "1.1.2.4",
      "title": "Ensure noexec option set on /tmp",
      "type": "mount-option",
      "mount_point": "/tmp",
      "options": ["noexec"]
    },
    {
      "id": "1.1.3.1",
      "title": "Ensure /var is a separate partition",
      "type": "command",
      "audit_cmd": "findmnt -n /var",
      "expected": "/var",
      "match": "contains"
    },
    {
      "id": "1.1.3.2",
      "title": "Ensure nodev option set on /var",
      "type": "mount-option",
      "mount_point": "/var",
      "options": ["nodev"]
    },
    {
      "id": "1.1.3.3",
      "title": "Ensure nosuid option set on /var",
      "type": "mount-option",
      "mount_point": "/var",
      "options": ["nosuid"]
    },
    {
      "id": "1.1.4.1",
      "title": "Ensure /var/tmp is a separate partition",
      "type": "command",
      "audit_cmd": "findmnt -n /var/tmp",
      "expected": "/var/tmp",
      "match": "contains"
    },
    {
      "id": "1.1.4.2",
      "title": "Ensure nodev option set on /var/tmp",
      "type": "mount-option",
      "mount_point": "/var/tmp",
      "options": ["nodev"]
    },
    {
      "id": "1.1.4.3",
      "title": "Ensure nosuid option set on /var/tmp",
      "type": "mount-option",
      "mount_point": "/var/tmp",
      "options": ["nosuid"]
    },
    {
      "id": "1.1.4.4",
      "title": "Ensure noexec option set on /var/tmp",
      "type": "mount-option",
      "mount_point": "/var/tmp",
      "options": ["noexec"]
    },
    {
      "id": "1.1.5.1",
      "title": "Ensure /var/log is a separate partition",
      "type": "command",
      "audit_cmd": "findmnt -n /var/log",
      "expected": "/var/log",
      "match": "contains"
    },
    {
      "id": "1.1.5.2",
      "title": "Ensure nodev option set on /var/log",
      "type": "mount-option",
      "mount_point": "/var/log",
      "options": ["nodev"]
    },
    {
      "id": "1.1.5.3",
      "title": "Ensure nosuid option set on /var/log",
      "type": "mount-option",
      "mount_point": "/var/log",
      "options": ["nosuid"]
    },
    {
      "id": "1.1.5.4",
      "title": "Ensure noexec option set on /var/log",
      "type": "mount-option",
      "mount_point": "/var/log",
      "options": ["noexec"]
    },
    {
      "id": "1.1.6.1",
      "title": "Ensure /var/log/audit is a separate partition",
      "type": "command",
      "audit_cmd": "findmnt -n /var/log/audit",
      "expected": "/var/log/audit",
      "match": "contains"
    },
    {
      "id": "1.1.6.2",
      "title": "Ensure nodev option set on /var/log/audit",
      "type": "mount-option",
      "mount_point": "/var/log/audit",
      "options": ["nodev"]
    },
    {
      "id": "1.1.6.3",
      "title": "Ensure nosuid option set on /var/log/audit",
      "type": "mount-option",
      "mount_point": "/var/log/audit",
      "options": ["nosuid"]
    },
    {
      "id": "1.1.6.4",
      "title": "Ensure noexec option set on /var/log/audit",
      "type": "mount-option",
      "mount_point": "/var/log/audit",
      "options": ["noexec"]
    },
    {
      "id": "1.1.7.1",
      "title": "Ensure /home is a separate partition",
      "type": "command",
      "audit_cmd": "findmnt -n /home",
      "expected": "/home",
      "match": "contains"
    },
    {
      "id": "1.1.7.2",
      "title": "Ensure nodev option set on /home",
      "type": "mount-option",
      "mount_point": "/home",
      "options": ["nodev"]
    },
    {
      "id": "1.1.7.3",
      "title": "Ensure nosuid option set on /home",
      "type": "mount-option",
      "mount_point": "/home",
      "options": ["nosuid"]
    },
    {
      "id": "1.1.8.1",
      "title": "Ensure nodev option set on /dev/shm",
      "type": "mount-option",
      "mount_point": "/dev/shm",
      "options": ["nodev"]
    },
    {
      "id": "1.1.8.2",
      "title": "Ensure nosuid option set on /dev/shm",
      "type": "mount-option",
      "mount_point": "/dev/shm",
      "options": ["nosuid"]
    },
    {
      "id": "1.1.8.3",
      "title": "Ensure noexec option set on /dev/shm",
      "type": "mount-option",
      "mount_point": "/dev/shm",
      "options": ["noexec"]
    },
    {
      "id": "1.2.1",
      "title": "Ensure GPG keys are configured",
      "type": "command",
      "audit_cmd": "rpm -qa gpg-pubkey",
      "match": "not_empty",
      "distro_only": "rhel9"
    },
    {
      "id": "1.2.1",
      "title": "Ensure GPG keys are configured",
      "type": "command",
      "audit_cmd": "apt-key list 2>/dev/null | grep -c 'pub'",
      "match": "not_empty",
      "distro_only": "ubuntu2404"
    },
    {
      "id": "1.2.2",
      "title": "Ensure repo_gpgcheck is globally activated",
      "type": "command",
      "audit_cmd": "grep -r 'repo_gpgcheck' /etc/yum.repos.d/ | grep -c '1'",
      "match": "not_empty",
      "distro_only": "rhel9"
    },
    {
      "id": "1.3.1.1",
      "title": "Ensure SELinux is installed",
      "type": "mac",
      "check_type": "installed",
      "distro_only": "rhel9"
    },
    {
      "id": "1.3.1.2",
      "title": "Ensure SELinux is not disabled in bootloader configuration",
      "type": "command",
      "audit_cmd": "grep -E 'selinux=0|enforcing=0' /boot/grub2/grubenv /etc/default/grub 2>/dev/null",
      "match": "empty",
      "distro_only": "rhel9"
    },
    {
      "id": "1.3.1.3",
      "title": "Ensure SELinux policy is configured",
      "type": "mac",
      "check_type": "policy",
      "expected": "targeted",
      "distro_only": "rhel9"
    },
    {
      "id": "1.3.1.4",
      "title": "Ensure SELinux mode is not disabled",
      "type": "mac",
      "check_type": "config",
      "directive": "SELINUX",
      "expected": "enforcing",
      "distro_only": "rhel9"
    },
    {
      "id": "1.3.1.5",
      "title": "Ensure SELinux mode is enforcing",
      "type": "mac",
      "check_type": "enforcing",
      "distro_only": "rhel9"
    },
    {
      "id": "1.3.1.6",
      "title": "Ensure no unconfined services exist",
      "type": "mac",
      "check_type": "unconfined",
      "distro_only": "rhel9"
    },
    {
      "id": "1.3.1.1",
      "title": "Ensure AppArmor is installed",
      "type": "mac",
      "check_type": "installed",
      "distro_only": "ubuntu2404"
    },
    {
      "id": "1.3.1.2",
      "title": "Ensure AppArmor is enabled in bootloader",
      "type": "command",
      "audit_cmd": "grep -E 'apparmor=1|security=apparmor' /etc/default/grub",
      "match": "not_empty",
      "distro_only": "ubuntu2404"
    },
    {
      "id": "1.3.1.3",
      "title": "Ensure all AppArmor profiles are in enforce mode",
      "type": "mac",
      "check_type": "enforcing",
      "distro_only": "ubuntu2404"
    },
    {
      "id": "1.3.1.4",
      "title": "Ensure all AppArmor profiles are loaded",
      "type": "mac",
      "check_type": "loaded",
      "distro_only": "ubuntu2404"
    },
    {
      "id": "1.4.1",
      "title": "Ensure bootloader password is set",
      "type": "command",
      "audit_cmd": "grep -E '^GRUB2_PASSWORD|^set superusers' /boot/grub2/user.cfg /boot/grub/grub.cfg 2>/dev/null",
      "match": "not_empty"
    },
    {
      "id": "1.4.2",
      "title": "Ensure permissions on bootloader config are configured",
      "type": "file-perms",
      "path": "/boot/grub2/grub.cfg",
      "mode": "600",
      "owner": "root",
      "group": "root"
    },
    {
      "id": "1.5.1",
      "title": "Ensure address space layout randomization (ASLR) is enabled",
      "type": "sysctl",
      "key": "kernel.randomize_va_space",
      "expected": "2"
    },
    {
      "id": "1.5.2",
      "title": "Ensure ptrace_scope is restricted",
      "type": "sysctl",
      "key": "kernel.yama.ptrace_scope",
      "expected": "1"
    },
    {
      "id": "1.5.3",
      "title": "Ensure core dump backtraces are disabled",
      "type": "file-content",
      "file": "/etc/systemd/coredump.conf",
      "directive": "ProcessSizeMax",
      "expected": "0",
      "separator": "="
    },
    {
      "id": "1.5.4",
      "title": "Ensure core dump storage is disabled",
      "type": "file-content",
      "file": "/etc/systemd/coredump.conf",
      "directive": "Storage",
      "expected": "none",
      "separator": "="
    },
    {
      "id": "1.6.1",
      "title": "Ensure system wide crypto policy is not legacy",
      "type": "command",
      "audit_cmd": "update-crypto-policies --show | grep -v LEGACY",
      "match": "not_empty",
      "distro_only": "rhel9"
    },
    {
      "id": "1.6.2",
      "title": "Ensure system wide crypto policy disables sha1 hash and CBC for SSH",
      "type": "command",
      "audit_cmd": "update-crypto-policies --show",
      "expected": "FUTURE",
      "match": "contains",
      "distro_only": "rhel9"
    },
    {
      "id": "1.7.1",
      "title": "Ensure message of the day is configured properly",
      "type": "command",
      "audit_cmd": "grep -Eis '(\\\\v|\\\\r|\\\\m|\\\\s|$(grep ^ID= /etc/os-release | cut -d= -f2))' /etc/motd",
      "match": "empty"
    },
    {
      "id": "1.7.2",
      "title": "Ensure local login warning banner is configured",
      "type": "command",
      "audit_cmd": "cat /etc/issue",
      "match": "not_empty"
    },
    {
      "id": "1.7.3",
      "title": "Ensure remote login warning banner is configured",
      "type": "command",
      "audit_cmd": "cat /etc/issue.net",
      "match": "not_empty"
    },
    {
      "id": "1.7.4",
      "title": "Ensure permissions on /etc/motd are configured",
      "type": "file-perms",
      "path": "/etc/motd",
      "mode": "644",
      "owner": "root",
      "group": "root"
    },
    {
      "id": "1.7.5",
      "title": "Ensure permissions on /etc/issue are configured",
      "type": "file-perms",
      "path": "/etc/issue",
      "mode": "644",
      "owner": "root",
      "group": "root"
    },
    {
      "id": "1.7.6",
      "title": "Ensure permissions on /etc/issue.net are configured",
      "type": "file-perms",
      "path": "/etc/issue.net",
      "mode": "644",
      "owner": "root",
      "group": "root"
    },
    {
      "id": "1.8.1",
      "title": "Ensure GNOME Display Manager is removed",
      "type": "package",
      "package": "gdm3",
      "expected": "not_installed"
    },
    {
      "id": "1.8.2",
      "title": "Ensure GDM login banner is configured",
      "type": "command",
      "audit_cmd": "grep -ri 'banner-message-enable' /etc/dconf/db/gdm.d/ 2>/dev/null",
      "match": "not_empty"
    },
    {
      "id": "1.8.3",
      "title": "Ensure GDM disable-user-list option is enabled",
      "type": "command",
      "audit_cmd": "grep -ri 'disable-user-list' /etc/dconf/db/gdm.d/ 2>/dev/null",
      "expected": "true",
      "match": "contains"
    },
    {
      "id": "1.8.4",
      "title": "Ensure GDM screen locks when the user is idle",
      "type": "command",
      "audit_cmd": "grep -ri 'idle-delay' /etc/dconf/db/gdm.d/ 2>/dev/null",
      "match": "not_empty"
    },
    {
      "id": "1.8.5",
      "title": "Ensure GDM screen locks cannot be overridden",
      "type": "command",
      "audit_cmd": "grep -rli 'idle-delay' /etc/dconf/db/gdm.d/locks/ 2>/dev/null",
      "match": "not_empty"
    },
    {
      "id": "1.8.6",
      "title": "Ensure GDM automatic mounting of removable media is disabled",
      "type": "command",
      "audit_cmd": "grep -ri 'automount=false' /etc/dconf/db/gdm.d/ 2>/dev/null",
      "match": "not_empty"
    },
    {
      "id": "1.8.7",
      "title": "Ensure GDM disabling automatic mounting of removable media is not overridden",
      "type": "command",
      "audit_cmd": "grep -rli 'automount' /etc/dconf/db/gdm.d/locks/ 2>/dev/null",
      "match": "not_empty"
    },
    {
      "id": "1.8.8",
      "title": "Ensure GDM autorun-never is enabled",
      "type": "command",
      "audit_cmd": "grep -ri 'autorun-never=true' /etc/dconf/db/gdm.d/ 2>/dev/null",
      "match": "not_empty"
    },
    {
      "id": "1.8.9",
      "title": "Ensure GDM autorun-never is not overridden",
      "type": "command",
      "audit_cmd": "grep -rli 'autorun-never' /etc/dconf/db/gdm.d/locks/ 2>/dev/null",
      "match": "not_empty"
    },
    {
      "id": "1.8.10",
      "title": "Ensure XDMCP is not enabled",
      "type": "command",
      "audit_cmd": "grep -Ei '^\\s*Enable\\s*=\\s*true' /etc/gdm/custom.conf /etc/gdm3/custom.conf 2>/dev/null",
      "match": "empty"
    }
  ]
}
