{
  "section": "4",
  "title": "Firewall Configuration",
  "description": "Firewalld, ufw, nftables rules (distro-specific)",
  "controls": [
    {
      "id": "4.1.1",
      "title": "Ensure firewalld is installed",
      "type": "firewall",
      "check_type": "installed",
      "distro_only": "rhel9"
    },
    {
      "id": "4.1.2",
      "title": "Ensure iptables-services is not installed with firewalld",
      "type": "package",
      "package": "iptables-services",
      "expected": "not_installed",
      "distro_only": "rhel9"
    },
    {
      "id": "4.1.3",
      "title": "Ensure nftables is not installed with firewalld",
      "type": "package",
      "package": "nftables",
      "expected": "not_installed",
      "distro_only": "rhel9"
    },
    {
      "id": "4.1.4",
      "title": "Ensure firewalld service is enabled and running",
      "type": "firewall",
      "check_type": "active",
      "distro_only": "rhel9",
      "audit_only": true
    },
    {
      "id": "4.1.5",
      "title": "Ensure firewalld default zone is set",
      "type": "firewall",
      "check_type": "default_zone",
      "expected": "drop",
      "distro_only": "rhel9",
      "audit_only": true
    },
    {
      "id": "4.1.6",
      "title": "Ensure network interfaces are assigned to appropriate zone",
      "type": "command",
      "audit_cmd": "firewall-cmd --get-active-zones",
      "expected": "",
      "match": "not_empty",
      "distro_only": "rhel9"
    },
    {
      "id": "4.1.7",
      "title": "Ensure firewalld drops unnecessary services and ports",
      "type": "command",
      "audit_cmd": "firewall-cmd --list-all",
      "expected": "",
      "match": "not_empty",
      "distro_only": "rhel9"
    },
    {
      "id": "4.2.1",
      "title": "Ensure ufw is installed",
      "type": "firewall",
      "check_type": "installed",
      "distro_only": "ubuntu2404"
    },
    {
      "id": "4.2.2",
      "title": "Ensure iptables-persistent is not installed with ufw",
      "type": "package",
      "package": "iptables-persistent",
      "expected": "not_installed",
      "distro_only": "ubuntu2404"
    },
    {
      "id": "4.2.3",
      "title": "Ensure ufw service is enabled",
      "type": "service",
      "service": "ufw",
      "expected": "enabled",
      "distro_only": "ubuntu2404",
      "audit_only": true
    },
    {
      "id": "4.2.4",
      "title": "Ensure ufw firewall rules exist for all open ports",
      "type": "command",
      "audit_cmd": "ufw status verbose",
      "expected": "",
      "match": "not_empty",
      "distro_only": "ubuntu2404"
    },
    {
      "id": "4.2.5",
      "title": "Ensure ufw default deny firewall policy",
      "type": "firewall",
      "check_type": "default_policy",
      "expected": "deny",
      "distro_only": "ubuntu2404",
      "audit_only": true
    },
    {
      "id": "4.2.6",
      "title": "Ensure ufw loopback traffic is configured",
      "type": "firewall",
      "check_type": "loopback",
      "distro_only": "ubuntu2404"
    },
    {
      "id": "4.2.7",
      "title": "Ensure ufw outbound connections are configured",
      "type": "command",
      "audit_cmd": "ufw status verbose | grep 'Default:'",
      "expected": "allow (outgoing)",
      "match": "contains",
      "distro_only": "ubuntu2404"
    },
    {
      "id": "4.3.1",
      "title": "Ensure nftables base chains exist",
      "type": "command",
      "audit_cmd": "nft list ruleset 2>/dev/null | grep 'type filter'",
      "expected": "",
      "match": "not_empty"
    }
  ]
}
